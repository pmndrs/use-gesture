{"version":3,"sources":["../../src/commands/clean.ts"],"names":["module","exports","clean","program","directory","report","directories","name","filter","Boolean","info","join","Promise","all","map","dir","fs","remove","path"],"mappings":";;;;AAAA;;AACA;;AACA;;AAEA;;AAQAA,MAAM,CAACC,OAAP,GAAiB,eAAeC,KAAf,CAAqBC,OAArB,EAAuD;AACtE,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAAwBF,OAA9B;AAEA,QAAMG,WAAW,GAAG,CACjB,QADiB,EAEjB,QAFiB,EAGlB;AACA,6BAAa;AACXC,IAAAA,IAAI,EAAG;AADI,GAAb,CAJkB,EAOlB,2BAAa;AACXA,IAAAA,IAAI,EAAG;AADI,GAAb,CAPkB,EAUlBC,MAVkB,CAUXC,OAVW,CAApB;AAYAJ,EAAAA,MAAM,CAACK,IAAP,CAAa,YAAWJ,WAAW,CAACK,IAAZ,CAAkB,IAAlB,CAAuB,EAA/C;AAEA,QAAMC,OAAO,CAACC,GAAR,CACJP,WAAW,CAACQ,GAAZ,CAAgBC,GAAG,IAAIC,iBAAGC,MAAH,CAAUC,cAAKP,IAAL,CAAUP,SAAV,EAAqBW,GAArB,CAAV,CAAvB,CADI,CAAN;AAIAV,EAAAA,MAAM,CAACK,IAAP,CAAa,kCAAb;;AAEA,MAAI,MAAM,yCAAV,EAAsC;AACpC;AACD,GAFD,MAEO,IAAI,MAAM,mDAAV,EAAgD;AACrD;AACD;AACF,CA5BD","sourcesContent":["import fs from \"fs-extra\"\nimport path from \"path\"\nimport findCacheDir from \"find-cache-dir\"\n\nimport {\n  userGetsSevenDayFeedback,\n  userPassesFeedbackRequestHeuristic,\n  showFeedbackRequest,\n  showSevenDayFeedbackRequest,\n} from \"../utils/feedback\"\nimport { IProgram } from \"./types\"\n\nmodule.exports = async function clean(program: IProgram): Promise<void> {\n  const { directory, report } = program\n\n  const directories = [\n    `.cache`,\n    `public`,\n    // Ensure we clean babel loader cache\n    findCacheDir({\n      name: `babel-loader`,\n    }),\n    findCacheDir({\n      name: `terser-webpack-plugin`,\n    }),\n  ].filter(Boolean)\n\n  report.info(`Deleting ${directories.join(`, `)}`)\n\n  await Promise.all(\n    directories.map(dir => fs.remove(path.join(directory, dir)))\n  )\n\n  report.info(`Successfully deleted directories`)\n\n  if (await userGetsSevenDayFeedback()) {\n    showSevenDayFeedbackRequest()\n  } else if (await userPassesFeedbackRequestHeuristic()) {\n    showFeedbackRequest()\n  }\n}\n"],"file":"clean.js"}